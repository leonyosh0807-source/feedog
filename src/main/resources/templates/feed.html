<!doctype html>
<html lang="ja" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>食事入力 | Feedog</title>
  <style>
    :root { color-scheme: light; }
    body { font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans JP", sans-serif; margin: 0; background: #f6f7fb; color: #111; }
    header { padding: 16px 18px; background: #fff; border-bottom: 1px solid #e7e7ee; }
    header h1 { margin: 0; font-size: 18px; }
    main { max-width: 720px; margin: 0 auto; padding: 18px; }
    .card { background: #fff; border: 1px solid #e7e7ee; border-radius: 12px; padding: 16px; box-shadow: 0 1px 0 rgba(0,0,0,.03); }
    .row { display: grid; gap: 10px; margin-top: 12px; }
    label { font-size: 13px; color: #333; }
    select, textarea { width: 100%; box-sizing: border-box; border: 1px solid #d8d8e3; border-radius: 10px; padding: 10px 12px; font-size: 15px; background: #fff; }
    textarea { min-height: 96px; resize: vertical; }
    .hint { font-size: 12px; color: #666; margin-top: 6px; }
    .btns { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-top: 16px; }
    button { border: none; border-radius: 12px; padding: 12px 14px; font-size: 16px; cursor: pointer; }
    .meal { background: #2f6fed; color: #fff; }
    .snack { background: #18a06b; color: #fff; }
    .sub { margin-top: 14px; display: flex; gap: 10px; align-items: center; flex-wrap: wrap; }
    a { color: #2f6fed; text-decoration: none; }
    a:hover { text-decoration: underline; }
    .err { background: #fff0f0; border: 1px solid #ffd2d2; padding: 10px 12px; border-radius: 10px; color: #b40000; margin-bottom: 12px; }
  </style>
</head>

<body>
<header>
  <h1>食事入力</h1>
</header>

<main>
  <!-- エラー表示（ControllerでerrorMessageを渡した場合に表示） -->
  <div class="err" th:if="${errorMessage != null}" th:text="${errorMessage}">エラーが発生しました。</div>

  <section class="card">
    <form th:action="@{/feed}" method="post">
      <!-- Spring Security を入れている場合だけCSRFが必要。無い場合は無視されます -->
      <input type="hidden" th:if="${_csrf != null}" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />

      <div class="row">
        <div>
          <label for="portion">量（未選択でもOK）</label>
          <select id="portion" name="portion">
            <!-- デフォルトは「普通」 -->
            <option value="" th:selected="${true}">（未選択）</option>
            <option value="MORE">多め</option>
            <option value="NORMAL" selected>普通</option>
            <option value="LESS">少なめ</option>
          </select>
          <div class="hint">※毎回測らない前提の「多め／普通／少なめ」</div>
        </div>

        <div>
          <label for="memo">メモ（任意）</label>
          <textarea id="memo" name="memo" placeholder="例：食欲あり、完食 / 少し残した など"></textarea>
          <div class="hint">未入力でも登録できます。</div>
        </div>
      </div>

      <div class="btns">
        <!-- kind は Controller で MEAL/SNACK を判定して FeedKind に変換する想定 -->
        <button class="meal" type="submit" name="kind" value="MEAL">ごはん</button>
        <button class="snack" type="submit" name="kind" value="SNACK">おやつ</button>
      </div>

      <div class="sub">
        <span class="hint" th:if="${now != null}">現在時刻：<span th:text="${#temporals.format(now, 'yyyy/MM/dd HH:mm')}">2025/01/01 00:00</span></span>
        <a th:href="@{/logs}">ログ一覧へ</a>
      </div>
    </form>
  </section>
</main>
</body>
</html>
